function B(t){return t.split("-")[1]}function J(t){return t==="y"?"height":"width"}function H(t){return t.split("-")[0]}function W(t){return["top","bottom"].includes(H(t))?"x":"y"}function Q(t,e,c){let{reference:o,floating:a}=t;const n=o.x+o.width/2-a.width/2,r=o.y+o.height/2-a.height/2,m=W(e),h=J(m),v=o[h]/2-a[h]/2,y=m==="x";let i;switch(H(e)){case"top":i={x:n,y:o.y-a.height};break;case"bottom":i={x:n,y:o.y+o.height};break;case"right":i={x:o.x+o.width,y:r};break;case"left":i={x:o.x-a.width,y:r};break;default:i={x:o.x,y:o.y}}switch(B(e)){case"start":i[m]-=v*(c&&y?-1:1);break;case"end":i[m]+=v*(c&&y?-1:1)}return i}const st=async(t,e,c)=>{const{placement:o="bottom",strategy:a="absolute",middleware:n=[],platform:r}=c,m=n.filter(Boolean),h=await(r.isRTL==null?void 0:r.isRTL(e));let v=await r.getElementRects({reference:t,floating:e,strategy:a}),{x:y,y:i}=Q(v,o,h),l=o,s={},u=0;for(let d=0;d<m.length;d++){const{name:p,fn:b}=m[d],{x,y:R,data:k,reset:P}=await b({x:y,y:i,initialPlacement:o,placement:l,strategy:a,middlewareData:s,rects:v,platform:r,elements:{reference:t,floating:e}});y=x??y,i=R??i,s={...s,[p]:{...s[p],...k}},P&&u<=50&&(u++,typeof P=="object"&&(P.placement&&(l=P.placement),P.rects&&(v=P.rects===!0?await r.getElementRects({reference:t,floating:e,strategy:a}):P.rects),{x:y,y:i}=Q(v,l,h)),d=-1)}return{x:y,y:i,placement:l,strategy:a,middlewareData:s}};function F(t,e){return typeof t=="function"?t(e):t}function _(t){return typeof t!="number"?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(t):{top:t,right:t,bottom:t,left:t}}function U(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function V(t,e){var c;e===void 0&&(e={});const{x:o,y:a,platform:n,rects:r,elements:m,strategy:h}=t,{boundary:v="clippingAncestors",rootBoundary:y="viewport",elementContext:i="floating",altBoundary:l=!1,padding:s=0}=F(e,t),u=_(s),d=m[l?i==="floating"?"reference":"floating":i],p=U(await n.getClippingRect({element:(c=await(n.isElement==null?void 0:n.isElement(d)))==null||c?d:d.contextElement||await(n.getDocumentElement==null?void 0:n.getDocumentElement(m.floating)),boundary:v,rootBoundary:y,strategy:h})),b=i==="floating"?{...r.floating,x:o,y:a}:r.reference,x=await(n.getOffsetParent==null?void 0:n.getOffsetParent(m.floating)),R=await(n.isElement==null?void 0:n.isElement(x))&&await(n.getScale==null?void 0:n.getScale(x))||{x:1,y:1},k=U(n.convertOffsetParentRelativeRectToViewportRelativeRect?await n.convertOffsetParentRelativeRectToViewportRelativeRect({rect:b,offsetParent:x,strategy:h}):b);return{top:(p.top-k.top+u.top)/R.y,bottom:(k.bottom-p.bottom+u.bottom)/R.y,left:(p.left-k.left+u.left)/R.x,right:(k.right-p.right+u.right)/R.x}}const G=Math.min,rt=Math.max;function I(t,e,c){return rt(t,G(e,c))}const ct=t=>({name:"arrow",options:t,async fn(e){const{x:c,y:o,placement:a,rects:n,platform:r,elements:m}=e,{element:h,padding:v=0}=F(t,e)||{};if(h==null)return{};const y=_(v),i={x:c,y:o},l=W(a),s=J(l),u=await r.getDimensions(h),d=l==="y",p=d?"top":"left",b=d?"bottom":"right",x=d?"clientHeight":"clientWidth",R=n.reference[s]+n.reference[l]-i[l]-n.floating[s],k=i[l]-n.reference[l],P=await(r.getOffsetParent==null?void 0:r.getOffsetParent(h));let E=P?P[x]:0;E&&await(r.isElement==null?void 0:r.isElement(P))||(E=m.floating[x]||n.floating[s]);const D=R/2-k/2,S=E/2-u[s]/2-1,C=G(y[p],S),w=G(y[b],S),g=C,A=E-u[s]-w,f=E/2-u[s]/2+D,O=I(g,f,A),T=B(a)!=null&&f!=O&&n.reference[s]/2-(f<g?C:w)-u[s]/2<0?f<g?g-f:A-f:0;return{[l]:i[l]-T,data:{[l]:O,centerOffset:f-O+T}}}}),$=["top","right","bottom","left"],X=$.reduce((t,e)=>t.concat(e,e+"-start",e+"-end"),[]),it={left:"right",right:"left",bottom:"top",top:"bottom"};function q(t){return t.replace(/left|right|bottom|top/g,e=>it[e])}function tt(t,e,c){c===void 0&&(c=!1);const o=B(t),a=W(t),n=J(a);let r=a==="x"?o===(c?"end":"start")?"right":"left":o==="start"?"bottom":"top";return e.reference[n]>e.floating[n]&&(r=q(r)),{main:r,cross:q(r)}}const at={start:"end",end:"start"};function j(t){return t.replace(/start|end/g,e=>at[e])}const ft=function(t){return t===void 0&&(t={}),{name:"autoPlacement",options:t,async fn(e){var c,o,a;const{rects:n,middlewareData:r,placement:m,platform:h,elements:v}=e,{crossAxis:y=!1,alignment:i,allowedPlacements:l=X,autoAlignment:s=!0,...u}=F(t,e),d=i!==void 0||l===X?function(w,g,A){return(w?[...A.filter(f=>B(f)===w),...A.filter(f=>B(f)!==w)]:A.filter(f=>H(f)===f)).filter(f=>!w||B(f)===w||!!g&&j(f)!==f)}(i||null,s,l):l,p=await V(e,u),b=((c=r.autoPlacement)==null?void 0:c.index)||0,x=d[b];if(x==null)return{};const{main:R,cross:k}=tt(x,n,await(h.isRTL==null?void 0:h.isRTL(v.floating)));if(m!==x)return{reset:{placement:d[0]}};const P=[p[H(x)],p[R],p[k]],E=[...((o=r.autoPlacement)==null?void 0:o.overflows)||[],{placement:x,overflows:P}],D=d[b+1];if(D)return{data:{index:b+1,overflows:E},reset:{placement:D}};const S=E.map(w=>{const g=B(w.placement);return[w.placement,g&&y?w.overflows.slice(0,2).reduce((A,f)=>A+f,0):w.overflows[0],w.overflows]}).sort((w,g)=>w[1]-g[1]),C=((a=S.filter(w=>w[2].slice(0,B(w[0])?2:3).every(g=>g<=0))[0])==null?void 0:a[0])||S[0][0];return C!==m?{data:{index:b+1,overflows:E},reset:{placement:C}}:{}}}},ut=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var c;const{placement:o,middlewareData:a,rects:n,initialPlacement:r,platform:m,elements:h}=e,{mainAxis:v=!0,crossAxis:y=!0,fallbackPlacements:i,fallbackStrategy:l="bestFit",fallbackAxisSideDirection:s="none",flipAlignment:u=!0,...d}=F(t,e),p=H(o),b=H(r)===r,x=await(m.isRTL==null?void 0:m.isRTL(h.floating)),R=i||(b||!u?[q(r)]:function(g){const A=q(g);return[j(g),A,j(A)]}(r));i||s==="none"||R.push(...function(g,A,f,O){const T=B(g);let L=function(M,z,et){const K=["left","right"],N=["right","left"],nt=["top","bottom"],ot=["bottom","top"];switch(M){case"top":case"bottom":return et?z?N:K:z?K:N;case"left":case"right":return z?nt:ot;default:return[]}}(H(g),f==="start",O);return T&&(L=L.map(M=>M+"-"+T),A&&(L=L.concat(L.map(j)))),L}(r,u,s,x));const k=[r,...R],P=await V(e,d),E=[];let D=((c=a.flip)==null?void 0:c.overflows)||[];if(v&&E.push(P[p]),y){const{main:g,cross:A}=tt(o,n,x);E.push(P[g],P[A])}if(D=[...D,{placement:o,overflows:E}],!E.every(g=>g<=0)){var S,C;const g=(((S=a.flip)==null?void 0:S.index)||0)+1,A=k[g];if(A)return{data:{index:g,overflows:D},reset:{placement:A}};let f=(C=D.filter(O=>O.overflows[0]<=0).sort((O,T)=>O.overflows[1]-T.overflows[1])[0])==null?void 0:C.placement;if(!f)switch(l){case"bestFit":{var w;const O=(w=D.map(T=>[T.placement,T.overflows.filter(L=>L>0).reduce((L,M)=>L+M,0)]).sort((T,L)=>T[1]-L[1])[0])==null?void 0:w[0];O&&(f=O);break}case"initialPlacement":f=r}if(o!==f)return{reset:{placement:f}}}return{}}}};function Y(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function Z(t){return $.some(e=>t[e]>=0)}const mt=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:c}=e,{strategy:o="referenceHidden",...a}=F(t,e);switch(o){case"referenceHidden":{const n=Y(await V(e,{...a,elementContext:"reference"}),c.reference);return{data:{referenceHiddenOffsets:n,referenceHidden:Z(n)}}}case"escaped":{const n=Y(await V(e,{...a,altBoundary:!0}),c.floating);return{data:{escapedOffsets:n,escaped:Z(n)}}}default:return{}}}}},dt=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){const{x:c,y:o}=e,a=await async function(n,r){const{placement:m,platform:h,elements:v}=n,y=await(h.isRTL==null?void 0:h.isRTL(v.floating)),i=H(m),l=B(m),s=W(m)==="x",u=["left","top"].includes(i)?-1:1,d=y&&s?-1:1,p=F(r,n);let{mainAxis:b,crossAxis:x,alignmentAxis:R}=typeof p=="number"?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...p};return l&&typeof R=="number"&&(x=l==="end"?-1*R:R),s?{x:x*d,y:b*u}:{x:b*u,y:x*d}}(e,t);return{x:c+a.x,y:o+a.y,data:a}}}};function lt(t){return t==="x"?"y":"x"}const pt=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:c,y:o,placement:a}=e,{mainAxis:n=!0,crossAxis:r=!1,limiter:m={fn:p=>{let{x:b,y:x}=p;return{x:b,y:x}}},...h}=F(t,e),v={x:c,y:o},y=await V(e,h),i=W(H(a)),l=lt(i);let s=v[i],u=v[l];if(n){const p=i==="y"?"bottom":"right";s=I(s+y[i==="y"?"top":"left"],s,s-y[p])}if(r){const p=l==="y"?"bottom":"right";u=I(u+y[l==="y"?"top":"left"],u,u-y[p])}const d=m.fn({...e,[i]:s,[l]:u});return{...d,data:{x:d.x-c,y:d.y-o}}}}};export{ut as A,mt as E,dt as L,pt as O,ft as b,ct as g,st as r,U as s};
